<!doctype html>
<html>
    <head>
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
        <meta name="description" content="keep coding, keep foolish"/>
        <meta name="keywords" content="ä»£ç ,æ•°å­¦,æ•°æ®æŒ–æ˜,æœºå™¨å­¦ä¹ ,ç®—æ³•,ç¼–è¯‘å™¨,åˆ†å¸ƒå¼,PHP,Nginx"/>
        <meta name="author" content="å¼ æ´‹"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
        <title>CodingLabs - æŠ“å–ç½‘é¡µå†…å®¹ç”ŸæˆKindleç”µå­ä¹¦
</title>
        <link rel="stylesheet" href="/assets/vendor/normalize.css"/>
        <link rel="stylesheet" href="/assets/vendor/google-code-prettify/prettify-solarized-dark.css"/>
        <link rel="stylesheet" href="/assets/themes/default/main.css"/>
        <link rel="shortcut icon" href="/fav.ico"/>
        <script type="text/javascript" src="/assets/vendor/google-code-prettify/prettify.js"></script>
        <script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3F75dfda8ff8a93fa0b94adeb17da37a2f' type='text/javascript'%3E%3C/script%3E"));
</script>

    </head>
    <body onload="prettyPrint()">
    <div id="header">
        <div id="header-inner">
            <div id="title"><a href="/">CodingLabs</a></div>
            <div id="subtitle">keep coding, keep foolish</div>
        </div>
    </div>

<div id="main">
    <div id="main-inner">
        <div id="topnav">
            <ul>
                <li><a href="/">é¦–é¡µ</a></li>
                <li class="sep"> | </li>
                <li><a href="/tag.html">æ ‡ç­¾</a></li>
                
<li class="sep"> | </li>
<li><a href="/pages/about-me.html" target="_self">å…³äºæˆ‘</a></li>

<li class="sep"> | </li>
<li><a href="/rss.xml" target="_self">+è®¢é˜…</a></li>

<li class="sep"> | </li>
<li><a href="https://github.com/ericzhang-cn/ailingbot" target="_blank">ğŸ¤–AilingBot - IMæœºå™¨äººæ¥å…¥AIèƒ½åŠ›çš„ä¸€ç«™å¼è§£å†³æ–¹æ¡ˆ</a></li>


            </ul>
            <div style="clear:both;"></div>
        </div>
        <div id="article-title">
            <a href="/articles/convert-html-to-kindle-book.html">æŠ“å–ç½‘é¡µå†…å®¹ç”ŸæˆKindleç”µå­ä¹¦</a>
        </div>
        <div id="article-meta">
            ä½œè€… å¼ æ´‹ | å‘å¸ƒäº 2014-03-27
        </div>
        <div id="article-tags">
        
        <a class="tag" href="/tag.html#Kindle">Kindle</a>
        
        <a class="tag" href="/tag.html#ç”µå­ä¹¦">ç”µå­ä¹¦</a>
        
        <a class="tag" href="/tag.html#ç»éªŒæŠ€å·§">ç»éªŒæŠ€å·§</a>
        
        </div>
        <div id="article-content">
            <p>è‡ªä»ä¹°äº†kindleåï¼Œæ€»æ˜¯æƒ³ç€å¦‚ä½•æœ€å¤§æ•ˆç”¨å‘æŒ¥å…¶æ•ˆç”¨ã€‚è™½ç„¶å¤šçœ‹ä¸Šæœ‰å¾ˆå¤šä¹¦å¯ä»¥è´­ä¹°ï¼Œç½‘ä¸Šä¹Ÿæœ‰å¾ˆå¤šå…è´¹çš„ç”µå­ä¹¦ï¼Œä½†æ˜¯ä»ç„¶æœ‰å¾ˆå¤šæ„Ÿå…´è¶£çš„å†…å®¹æ˜¯ä»¥ç½‘é¡µçš„å½¢å¼å­˜åœ¨çš„ã€‚ä¾‹å¦‚<a href="http://chimera.labs.oreilly.com/books/">Oâ€™Reilly Atlas</a>å°±æä¾›äº†è¯¸å¤šç”µå­ä¹¦ï¼Œä½†æ˜¯åªæä¾›å…è´¹çš„åœ¨çº¿é˜…è¯»ï¼›å¦å¤–è¿˜æœ‰å¾ˆå¤šèµ„æ–™æˆ–æ–‡æ¡£éƒ½åªæœ‰ç½‘é¡µå½¢å¼ã€‚äºæ˜¯å°±å¸Œæœ›é€šè¿‡æŸç§æ–¹æ³•è®²è¿™äº›åœ¨çº¿èµ„æ–™è½¬ä¸ºepubæˆ–mobiæ ¼å¼ï¼Œä»¥ä¾¿åœ¨kindleä¸Šé˜…è¯»ã€‚è¿™ç¯‡æ–‡ç« ä»‹ç»äº†å¦‚ä½•å€ŸåŠ©calibreå¹¶ç¼–å†™å°‘é‡ä»£ç æ¥è¾¾åˆ°è¿™ä¸ªç›®çš„ã€‚</p>
<h1 id="calibre">Calibre</h1>
<h2 id="calibreç®€ä»‹">Calibreç®€ä»‹</h2>
<p><a href="http://calibre-ebook.com/">Calibre</a>æ˜¯ä¸€ä¸ªå…è´¹çš„ç”µå­ä¹¦ç®¡ç†å·¥å…·ï¼Œå¯ä»¥å…¼å®¹Windows, OS XåŠLinuxï¼Œä»¤äººæ¬£å–œçš„æ˜¯ï¼Œé™¤äº†GUIå¤–ï¼Œcalibreè¿˜æä¾›äº†è¯¸å¤šå‘½ä»¤è¡Œå·¥å…·ï¼Œå…¶ä¸­çš„ebook-convertå‘½ä»¤å¯ä»¥æ ¹æ®ç”¨æˆ·ç¼–å†™çš„recipesæ–‡ä»¶ï¼ˆå®é™…æ˜¯pythonä»£ç ï¼‰æŠ“å–æŒ‡å®šé¡µé¢å†…å®¹å¹¶ç”Ÿæˆmobiç­‰æ ¼å¼çš„ç”µå­ä¹¦ã€‚é€šè¿‡ç¼–å†™recipeså¯ä»¥è‡ªå®šåˆ¶æŠ“å–è¡Œä¸ºï¼Œä»¥é€‚åº”ä¸åŒçš„ç½‘é¡µç»“æ„ã€‚</p>
<h2 id="å®‰è£…calibre">å®‰è£…Calibre</h2>
<p>Calibreçš„ä¸‹è½½åœ°å€æ˜¯<a href="http://calibre-ebook.com/download">http://calibre-ebook.com/download</a>ï¼Œå¯ä»¥æ ¹æ®è‡ªå·±çš„æ“ä½œç³»ç»Ÿä¸‹è½½ç›¸åº”çš„å®‰è£…ç¨‹åºã€‚</p>
<p>å¦‚æœæ˜¯Linuxæ“ä½œç³»ç»Ÿï¼Œè¿˜å¯ä»¥é€šè¿‡è½¯ä»¶ä»“åº“å®‰è£…ï¼š</p>
<p>Archlinuxï¼š</p>
<pre class="prettyprint linenums lang-bash">pacman -S calibre</pre>
<p>Debian/Ubuntuï¼š</p>
<pre class="prettyprint linenums lang-bash">apt-get install calibre</pre>
<p>RedHat/Fedora/CentOSï¼š</p>
<pre class="prettyprint linenums lang-bash">yum -y install calibre</pre>
<p>æ³¨æ„ï¼Œå¦‚æœä½ ä½¿ç”¨OSXï¼Œéœ€è¦å•ç‹¬å®‰è£…<a href="http://manual.calibre-ebook.com/cli/cli-index.html">Command Line Tool</a>ã€‚</p>
<h1 id="æŠ“å–ç½‘é¡µç”Ÿæˆç”µå­ä¹¦">æŠ“å–ç½‘é¡µç”Ÿæˆç”µå­ä¹¦</h1>
<p>ä¸‹é¢ä»¥<a href="http://chimera.labs.oreilly.com/books/1230000000561">Git Pocket Guide</a>ä¸ºä¾‹ï¼Œè¯´æ˜å¦‚ä½•é€šè¿‡calibreä»ç½‘é¡µç”Ÿæˆç”µå­ä¹¦ã€‚</p>
<h2 id="æ‰¾åˆ°indexé¡µ">æ‰¾åˆ°indexé¡µ</h2>
<p>è¦æŠ“å–æ•´æœ¬ä¹¦ï¼Œç¬¬ä¸€ä»¶äº‹å°±æ˜¯æ‰¾åˆ°indexé¡µï¼Œè¿™ä¸ªé¡µé¢ä¸€èˆ¬æ˜¯Table of Contentsï¼Œä¹Ÿå°±æ˜¯ç›®å½•é¡µï¼Œå…¶ä¸­æ¯ä¸ªç›®å½•é¡¹é“¾æ¥åˆ°ç›¸åº”å†…å®¹é¡µã€‚indexé¡µå°†ä¼šæŒ‡å¯¼æŠ“å–å“ªäº›é¡µé¢ä»¥åŠç”Ÿæˆç”µå­ä¹¦æ—¶å†…å®¹ç»„ç»‡é¡ºåºã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œindexé¡µé¢æ˜¯<a href="http://chimera.labs.oreilly.com/books/1230000000561/index.html">http://chimera.labs.oreilly.com/books/1230000000561/index.html</a>ã€‚</p>
<h2 id="ç¼–å†™recipes">ç¼–å†™recipes</h2>
<p>Recipesæ˜¯ä¸€ä¸ªä»¥recipeä¸ºæ‰©å±•åçš„è„šæœ¬ï¼Œå†…å®¹å®é™…ä¸Šæ˜¯ä¸€æ®µpythonä»£ç ï¼Œç”¨æ¥å®šä¹‰calibreæŠ“å–é¡µé¢çš„èŒƒå›´å’Œè¡Œä¸ºï¼Œä¸‹é¢æ˜¯ç”¨äºæŠ“å–Git Pocket Guideçš„recipesï¼š</p>
<pre class="prettyprint linenums lang-python">from calibre.web.feeds.recipes import BasicNewsRecipe

class Git_Pocket_Guide(BasicNewsRecipe):

    title = &#39;Git Pocket Guide&#39;
    description = &#39;&#39;
    cover_url = &#39;http://akamaicovers.oreilly.com/images/0636920024972/lrg.jpg&#39;

    url_prefix = &#39;http://chimera.labs.oreilly.com/books/1230000000561/&#39;
    no_stylesheets = True
    keep_only_tags = [{ &#39;class&#39;: &#39;chapter&#39; }]

    def get_title(self, link):
        return link.contents[0].strip()

    def parse_index(self):
        soup = self.index_to_soup(self.url_prefix + &#39;index.html&#39;)

        div = soup.find(&#39;div&#39;, { &#39;class&#39;: &#39;toc&#39; })

        articles = []
        for link in div.findAll(&#39;a&#39;):
            if &#39;#&#39; in link[&#39;href&#39;]:
                continue

            if not &#39;ch&#39; in link[&#39;href&#39;]:
                continue

            til = self.get_title(link)
            url = self.url_prefix + link[&#39;href&#39;]
            a = { &#39;title&#39;: til, &#39;url&#39;: url }

            articles.append(a)

        ans = [(&#39;Git_Pocket_Guide&#39;, articles)]

        return ans</pre>
<p>ä¸‹é¢åˆ†åˆ«è§£é‡Šä»£ç ä¸­ä¸åŒéƒ¨åˆ†ã€‚</p>
<h3 id="æ€»ä½“ç»“æ„">æ€»ä½“ç»“æ„</h3>
<p>æ€»ä½“æ¥çœ‹ï¼Œä¸€ä¸ªrecipeså°±æ˜¯ä¸€ä¸ªpython classï¼Œåªä¸è¿‡è¿™ä¸ªclasså¿…é¡»ç»§æ‰¿calibre.web.feeds.recipes.BasicNewsRecipeã€‚</p>
<h3 id="parse_index">parse_index</h3>
<p>æ•´ä¸ªrecipesçš„æ ¸å¿ƒæ–¹æ³•æ˜¯parse_indexï¼Œä¹Ÿæ˜¯recipeså”¯ä¸€å¿…é¡»å®ç°çš„æ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•çš„ç›®æ ‡æ˜¯é€šè¿‡åˆ†æindexé¡µé¢çš„å†…å®¹ï¼Œè¿”å›ä¸€ä¸ªç¨æ˜¾å¤æ‚çš„æ•°æ®ç»“æ„ï¼ˆç¨åä»‹ç»ï¼‰ï¼Œè¿™ä¸ªæ•°æ®ç»“æ„å®šä¹‰äº†æ•´ä¸ªç”µå­ä¹¦çš„å†…å®¹åŠå†…å®¹ç»„ç»‡é¡ºåºã€‚</p>
<h3 id="æ€»ä½“å±æ€§è®¾ç½®">æ€»ä½“å±æ€§è®¾ç½®</h3>
<p>åœ¨classçš„å¼€å§‹ï¼Œå®šä¹‰äº†ä¸€äº›å…¨å±€å±æ€§ï¼š</p>
<pre class="prettyprint linenums lang-python">title = &#39;Git Pocket Guide&#39;
description = &#39;&#39;
cover_url = &#39;http://akamaicovers.oreilly.com/images/0636920024972/lrg.jpg&#39;

url_prefix = &#39;http://chimera.labs.oreilly.com/books/1230000000561/&#39;
no_stylesheets = True
keep_only_tags = [{ &#39;class&#39;: &#39;chapter&#39; }]</pre>
<ul>
<li>titleï¼šç”µå­ä¹¦æ ‡é¢˜</li>
<li>descriptionï¼šç”µå­ä¹¦æè¿°</li>
<li>cover_urlï¼šç”µå­ä¹¦çš„å°é¢å›¾ç‰‡</li>
<li>url_prefixï¼šè¿™æ˜¯æˆ‘è‡ªç”¨çš„å±æ€§ï¼Œæ˜¯å†…å®¹é¡µé¢çš„å‰ç¼€ï¼Œç”¨äºåé¢æ‹¼è£…å†…å®¹é¡µçš„å®Œæ•´url</li>
<li>no_stylesheetsï¼šä¸è¦ä½¿ç”¨é¡µé¢CSSæ ·å¼</li>
<li>keep_only_tagsï¼šè¿™ä¸€è¡Œå‘Šè¯‰calibreåˆ†æindexé¡µæ—¶ä»…è€ƒè™‘classå±æ€§ä¸ºâ€œchapterâ€çš„DOMå…ƒç´ ï¼Œå¦‚æœä½ çœ‹indexé¡µçš„æºç ä¼šå‘ç°è¿™å¯¹åº”ä¸€çº§æ ‡é¢˜ã€‚ä¹‹æ‰€ä»¥è¿™æ ·æ˜¯å› ä¸ºåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œindexé¡µé¢æ¯ä¸ªä¸€çº§æ ‡é¢˜å¯¹åº”ä¸€ä¸ªç‹¬ç«‹å†…å®¹é¡µï¼Œè€ŒäºŒçº§æ ‡é¢˜ä»…é“¾æ¥åˆ°é¡µé¢ä¸­æŸä¸ªé”šç‚¹ï¼ˆanchorï¼‰ï¼Œæ‰€ä»¥ä»…éœ€è€ƒè™‘ä¸€çº§æ ‡é¢˜</li>
</ul>
<h3 id="parse_indexè¿”å›å€¼">parse_indexè¿”å›å€¼</h3>
<p>ä¸‹é¢ä»‹ç»parse_indexéœ€è¦é€šè¿‡åˆ†æindexé¡µé¢è¿”å›çš„æ•°æ®ç»“æ„ã€‚</p>
<p class="picture"><img alt="" src="/uploads/pictures/convert-html-to-kindle-book/01.png"/></p>

<p>æ€»ä½“è¿”å›æ•°æ®ç»“æ„æ˜¯ä¸€ä¸ªlistï¼Œå…¶ä¸­æ¯ä¸ªå…ƒç´ æ˜¯ä¸€ä¸ªtupleï¼Œä¸€ä¸ªtupleè¡¨ç¤ºä¸€å·ï¼ˆvolumeï¼‰ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­åªæœ‰ä¸€å·ï¼Œæ‰€ä»¥listä¸­åªæœ‰ä¸€ä¸ªtupleã€‚</p>
<p>æ¯ä¸ªtupleæœ‰ä¸¤ä¸ªå…ƒç´ ï¼Œç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯å·åï¼Œç¬¬äºŒä¸ªå…ƒç´ æ˜¯ä¸€ä¸ªlistï¼Œlistä¸­æ¯ä¸ªå…ƒç´ æ˜¯ä¸€ä¸ªmapï¼Œè¡¨ç¤ºä¸€ç« ï¼ˆchapterï¼‰ï¼Œmapä¸­æœ‰ä¸¤ä¸ªå…ƒç´ ï¼štitleå’Œurlï¼Œtitleæ˜¯ç« èŠ‚æ ‡é¢˜ï¼Œurlæ˜¯ç« èŠ‚æ‰€åœ¨å†…å®¹é¡µçš„urlã€‚</p>
<p>Calibreä¼šæ ¹æ®parse_indexçš„è¿”å›ç»“æœæŠ“å–å¹¶ç»„ç»‡æ•´ä¸ªä¹¦ï¼Œå¹¶ä¸”ä¼šè‡ªè¡ŒæŠ“å–å¹¶å¤„ç†å†…å®¹ä¸­å¤–é“¾çš„å›¾ç‰‡ã€‚</p>
<p>æ•´ä¸ªparse_indexä½¿ç”¨soupè§£æindexé¡µå¹¶ç”Ÿæˆä¸Šè¿°æ•°æ®ç»“æ„ã€‚</p>
<h3 id="æ›´å¤š">æ›´å¤š</h3>
<p>ä¸Šé¢æ˜¯æœ€åŸºæœ¬çš„recipesï¼Œæƒ³äº†è§£æ›´å¤šçš„ä½¿ç”¨æ–¹æ³•ï¼Œå¯ä»¥å‚è€ƒ<a href="http://manual.calibre-ebook.com/news_recipe.html">APIæ–‡æ¡£</a>ã€‚</p>
<h2 id="ç”Ÿæˆmobi">ç”Ÿæˆmobi</h2>
<p>ç¼–å†™å¥½recipesåï¼Œåœ¨å‘½ä»¤è¡Œä¸‹é€šè¿‡å¦‚ä¸‹å‘½ä»¤å³å¯ç”Ÿæˆç”µå­ä¹¦ï¼š</p>
<pre class="prettyprint linenums lang-bash">ebook-convert Git_Pocket_Guide.recipe Git_Pocket_Guide.mobi</pre>
<p>å³å¯ç”Ÿæˆmobiæ ¼å¼çš„ç”µå­ä¹¦ã€‚ebook-convertä¼šæ ¹æ®recipesä»£ç è‡ªè¡ŒæŠ“å–ç›¸å…³å†…å®¹å¹¶ç»„ç»‡ç»“æ„ã€‚</p>
<h1 id="æœ€ç»ˆæ•ˆæœ">æœ€ç»ˆæ•ˆæœ</h1>
<p>ä¸‹é¢æ˜¯åœ¨kindleä¸Šçœ‹åˆ°çš„æ•ˆæœã€‚</p>
<p>ç›®å½•</p>
<p class="picture"><img alt="" src="/uploads/pictures/convert-html-to-kindle-book/02.jpg"/></p>

<p>å†…å®¹ä¸€</p>
<p class="picture"><img alt="" src="/uploads/pictures/convert-html-to-kindle-book/03.jpg"/></p>

<p>å†…å®¹äºŒ</p>
<p class="picture"><img alt="" src="/uploads/pictures/convert-html-to-kindle-book/04.jpg"/></p>

<p>å«æœ‰å›¾ç‰‡çš„é¡µ</p>
<p class="picture"><img alt="" src="/uploads/pictures/convert-html-to-kindle-book/05.jpg"/></p>

<p>å®é™…æ•ˆæœ</p>
<p class="picture"><img alt="" src="/uploads/pictures/convert-html-to-kindle-book/06.jpg"/></p>

<h1 id="æˆ‘çš„recipesä»“åº“">æˆ‘çš„recipesä»“åº“</h1>
<p>æˆ‘åœ¨githubä¸Šå»ºäº†ä¸€ä¸ª<a href="https://github.com/ericzhang-cn/kindle-open-books/">kindle-open-books</a>ï¼Œé‡Œé¢æ”¾äº†ä¸€äº›recipesï¼Œæœ‰æˆ‘å†™çš„ï¼Œä¹Ÿæœ‰å…¶ä»–åŒå­¦è´¡çŒ®çš„ã€‚æ¬¢è¿ä»»ä½•äººè´¡çŒ®çš„recipesã€‚</p>

        </div>
        <!-- Go to www.addthis.com/dashboard to customize your tools -->
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5c74f9b0c9ea5242"></script>
<!-- Go to www.addthis.com/dashboard to customize your tools -->
<div class="addthis_inline_share_toolbox"></div>

    </div>
</div>
        <div id="footer">
            <div id="footer-inner">
                <p id="copyright">Copyright (c) 2011-2019 CodingLabs æœ¬åšå®¢å†…å®¹é‡‡ç”¨<a href="http://creativecommons.org/licenses/by/3.0/cn/" target="_blank">çŸ¥è¯†å…±äº«ç½²å 3.0 ä¸­å›½å¤§é™†è®¸å¯åè®®</a>è¿›è¡Œè®¸å¯</p>
            </div>
        </div>
        <script type="text/x-mathjax-config">
            MathJax.Hub.Config({
                tex2jax: {
                    inlineMath: [['$','$'], ['\\(','\\)']],
                    processEscapes: true
                }
            });
        </script>
        <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </body>
</html>

